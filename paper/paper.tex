% Created 2020-06-25 jeu. 10:07
% Intended LaTeX compiler: pdflatex
\documentclass{ISMA_USD2020}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage[most]{tcolorbox}
\usepackage{bm}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{array}
\usepackage{siunitx}
\usepackage{amsmath,amssymb,amsfonts, cases}
\usepackage{algorithmic, graphicx, textcomp}
\usepackage{xcolor, import, hyperref}
\usepackage{subcaption}
\usepackage[USenglish, english]{babel}
\setcounter{footnote}{1}
\input{config.tex}
\author[1,3] {T. Dehaeze}
\author[1,2] {C. Collette}
\affil[1] {Precision Mechatronics Laboratory\NewLineAffil University of Liege, Belgium \NewAffil}
\affil[2] {BEAMS Department\NewLineAffil Free University of Brussels, Belgium \NewAffil}
\affil[3] {European Synchrotron Radiation Facility \NewLineAffil Grenoble, France e-mail: \textbf{thomas.dehaeze@esrf.fr}}
\bibliographystyle{IEEEtran}
\usepackage{tikz}
\usetikzlibrary{shapes.misc}
\date{}
\title{Decentralized Active Damping of Rotating Positioning Platforms}
\hypersetup{
 pdfauthor={},
 pdftitle={Decentralized Active Damping of Rotating Positioning Platforms},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 27.0.91 (Org mode 9.4)}, 
 pdflang={English}}
\begin{document}

\maketitle

\abstract{
    Abstract text to be done
}

\section{Introduction}
\label{sec:org5780a8f}
\label{sec:introduction}
Controller Poles are shown by black crosses (
\begin{tikzpicture} \node[cross out, draw=black, minimum size=1ex, line width=2pt, inner sep=0pt, outer sep=0pt] at (0, 0){}; \end{tikzpicture}
).
This paper has been published
The Matlab code that was use to obtain the results are available in \cite{dehaeze20_activ_dampin_rotat_posit_platf}.

\section{Dynamics of Rotating Positioning Platforms}
\label{sec:orga8db619}
\subsection{Studied Rotating Positioning Platform}
\label{sec:org70ddefe}
Consider the rotating X-Y stage of Figure \ref{fig:system}.

\begin{itemize}
\item \(k\): Actuator's Stiffness [N/m]
\item \(m\): Payload's mass [kg]
\item \(\Omega = \dot{\theta}\): rotation speed [rad/s]
\item \(F_u\), \(F_v\)
\item \(d_u\), \(d_v\)
\end{itemize}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/system.pdf}
\caption{\label{fig:system}Schematic of the studied System}
\end{figure}

\subsection{Equations of Motion}
\label{sec:org647b64d}
The system has two degrees of freedom and is thus fully described by the generalized coordinates \([q_1\ q_2] = [d_u\ d_v]\) (describing the position of the mass in the rotating frame).

Let's express the kinetic energy \(T\), the potential energy \(V\) of the mass \(m\) (neglecting the rotational energy) as well as the deceptive function \(R\):
\begin{subequations}
\label{eq:energy_functions_lagrange}
  \begin{align}
    T & = \frac{1}{2} m \left( \left( \dot{d}_u - \Omega d_v \right)^2 + \left( \dot{d}_v + \Omega d_u \right)^2 \right) \\
    V & = \frac{1}{2} k \left( {d_u}^2 + {d_v}^2 \right) \\
    R & = \frac{1}{2} c \left( \dot{d}_u{}^2 + \dot{d}_v{}^2 \right)
  \end{align}
\end{subequations}

The equations of motion are derived from the Lagrangian equation:
\begin{equation}
\label{eq:lagrangian_equations}
  \frac{d}{dt} \left( \frac{\partial L}{\partial \dot{q}_i} \right) + \frac{\partial D}{\partial \dot{q}_i} - \frac{\partial L}{\partial q_i} = Q_i
\end{equation}
with \(L = T - V\) is the Lagrangian and \(Q_i\) is the generalized force associated with the generalized variable \(q_i\) (\(Q_1 = F_u\) and \(Q_2 = F_v\)).

\begin{subequations}
\label{eq:eom_coupled}
  \begin{align}
    m \ddot{d}_u + c \dot{d}_u + ( k - m \Omega ) d_u &= F_u + 2 m \Omega \dot{d}_v \\
    m \ddot{d}_v + c \dot{d}_v + ( k \underbrace{-\,m \Omega}_{\text{Centrif.}} ) d_v &= F_v \underbrace{-\,2 m \Omega \dot{d}_u}_{\text{Coriolis}}
  \end{align}
\end{subequations}

The Gyroscopic effects can be seen from the two following terms:
\begin{itemize}
\item Coriolis Forces: coupling
\item Centrifugal forces: negative stiffness
\end{itemize}

\subsection{Transfer Functions in the Laplace domain}
\label{sec:org55c9228}

Using the Laplace transformation on the equations of motion \eqref{eq:eom_coupled}, the transfer functions from \([F_u,\ F_v]\) to \([d_u,\ d_v]\) are obtained:
\begin{subequations}
\label{eq:oem_laplace_domain}
  \begin{align}
    d_u &= \frac{ms^2 + cs + k - m \Omega^2}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2} F_u +  \frac{2 m \Omega s}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2} F_v \\
    d_v &= \frac{-2 m \Omega s}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2} F_u +  \frac{ms^2 + cs + k - m \Omega^2}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2} F_v
  \end{align}
\end{subequations}


Without rotation \(\Omega = 0\) and the system corresponds to two uncoupled one degree of freedom mass-spring-damper systems:
\begin{subequations}
\label{eq:oem_no_rotation}
  \begin{align}
    d_u &= \frac{1}{m s^2 + cs + k} F_u \\
    d_v &= \frac{1}{m s^2 + cs + k} F_v
  \end{align}
\end{subequations}

\subsection{Change of Variables / Parameters for the study}
\label{sec:orgb7d090c}

In order this study is more independent on the system parameters, the following change of variable is performed:
\begin{itemize}
\item \(\omega_0 = \sqrt{\frac{k}{m}}\): Natural frequency of the mass-spring system in \(\si{\radian/\s}\)
\item \(\xi = \frac{c}{2 \sqrt{k m}}\): Damping ratio
\end{itemize}

\begin{equation}
\label{eq:tf_d}
  \begin{bmatrix} d_u \\ d_v \end{bmatrix} = \bm{G}_d \begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}
Where \(\bm{G}_d\) is a \(2 \times 2\) transfer function matrix.

\begin{equation}
\bm{G}_d = \frac{1}{k} \frac{1}{G_{dp}}
\begin{bmatrix}
   G_{dz} & G_{dc} \\
  -G_{dc} & G_{dz}
\end{bmatrix}
\end{equation}
With:
\begin{subequations}
  \begin{align}
    G_{dp} &= \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2 \\
    G_{dz} &= \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \\
    G_{dc} &= 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0}
  \end{align}
\end{subequations}

\(G_{dp}\) describes to poles of the system, \(G_{dz}\) the zeros of the diagonal terms and \(G_{dc}\) the coupling.

\subsection{System Dynamics and Campbell Diagram}
\label{sec:org24f5f5f}
The bode plot of \(\bm{G}_d\) is shown in Figure \ref{fig:plant_compare_rotating_speed}.

\begin{figure}[htbp]
\begin{subfigure}[c]{0.45\linewidth}
\includegraphics[width=\linewidth]{figs/plant_compare_rotating_speed_direct.pdf}
\caption{\label{fig:plant_compare_rotating_speed_direct} Direct Terms \(d_u/F_u\), \(d_v/F_v\)}
\end{subfigure}
\begin{subfigure}[c]{0.45\linewidth}
\includegraphics[width=\linewidth]{figs/plant_compare_rotating_speed_coupling.pdf}
\caption{\label{fig:plant_compare_rotating_speed_coupling} Coupling Terms \(d_v/F_u\), \(d_u/F_v\)}
\end{subfigure}
\caption{\label{fig:plant_compare_rotating_speed}Bode Plots for \(\bm{G}_d\)}
\centering
\end{figure}



When the rotation speed in non-null, the resonance frequency is split into two pairs of complex conjugate poles.
As the rotation speed increases, one of the two resonant frequency goes to lower frequencies as the other one goes to higher frequencies.

When the rotational speed \(\Omega\) reaches \(\omega_0\), the real part of one pair of complex conjugate becomes position meaning is system is unstable.

The stiffness of the X-Y stage is too small to hold to rotating payload hence the instability.

Stiff positioning platforms should be used if high rotational speeds or heavy payloads are used.

\begin{figure}[htbp]
\begin{subfigure}[c]{0.4\linewidth}
\includegraphics[width=\linewidth]{figs/campbell_diagram_real.pdf}
\caption{\label{fig:campbell_diagram_real} Real Part}
\end{subfigure}
\begin{subfigure}[c]{0.4\linewidth}
\includegraphics[width=\linewidth]{figs/campbell_diagram_imag.pdf}
\caption{\label{fig:campbell_diagram_imag} Imaginary Part}
\end{subfigure}
\caption{\label{fig:campbell_diagram}Campbell Diagram : Evolution of the poles as a function of the rotational speed \(\Omega\)}
\centering
\end{figure}

\section{Decentralized Integral Force Feedback}
\label{sec:orgd957fd6}
\subsection{Control Schematic}
\label{sec:orgc01d8cf}

Force Sensors are added in series with the actuators as shown in Figure \ref{fig:system_iff}.

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/system_iff.pdf}
\caption{\label{fig:system_iff}System with Force Sensors in Series with the Actuators. Decentralized Integral Force Feedback is used}
\end{figure}

\subsection{Equations}
\label{sec:orge5896ec}
The forces measured by the force sensors are equal to:
\begin{equation}
\label{eq:measured_force}
  \begin{bmatrix} f_{u} \\ f_{v} \end{bmatrix} =
  \begin{bmatrix} F_u \\ F_v \end{bmatrix} - (c s + k)
  \begin{bmatrix} d_u \\ d_v \end{bmatrix}
\end{equation}

Reinjecting \eqref{eq:tf_d} into \eqref{eq:measured_force} yields:
\begin{equation}
\label{eq:tf_f}
\begin{bmatrix} f_{u} \\ f_{v} \end{bmatrix} = \bm{G}_{f} \begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}

\begin{equation}
\bm{G}_f =
\frac{1}{G_{fp}}
\begin{bmatrix}
  G_{fz} & -G_{fc} \\
  G_{fc} &  G_{fz}
\end{bmatrix}
\end{equation}

\begin{align}
  G_{fp} &= \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2 \\
  G_{fz} &= \left( \frac{s^2}{{\omega_0}^2} - \frac{\Omega^2}{{\omega_0}^2} \right) \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right) + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2 \\
  G_{fc} &= \left( 2 \xi \frac{s}{\omega_0} + 1 \right) \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)
\end{align}

\begin{equation}
\bm{G}_f =
\frac{1}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2}
\begin{bmatrix}
  \left( \frac{s^2}{{\omega_0}^2} - \frac{\Omega^2}{{\omega_0}^2} \right) \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right) + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2 & -G_{fc} \\
  G_{fc} &  \left( \frac{s^2}{{\omega_0}^2} - \frac{\Omega^2}{{\omega_0}^2} \right) \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right) + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2
\end{bmatrix}
\end{equation}

\subsection{Plant Dynamics}
\label{sec:org0a22a10}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/plant_iff_compare_rotating_speed.pdf}
\caption{\label{fig:plant_iff_compare_rotating_speed}Bode plot of \(\bm{G}_f\) for several rotational speeds \(\Omega\)}
\end{figure}

\subsection{Problems with Integral Force Feedback}
\label{sec:orgd432439}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/root_locus_pure_iff.pdf}
\caption{\label{fig:root_locus_pure_iff}Root Locus for the Decentralized Integral Force Feedback}
\end{figure}

At low frequency, the gain is very large and thus no force is transmitted between the payload and the rotating stage.
This means that at low frequency, the system is decoupled (the force sensor removed) and thus the system is unstable.

\section{Integral Force Feedback with High Pass Filters}
\label{sec:org2e1883a}
\subsection{Modification of the Control Low}
\label{sec:org218110f}
\begin{equation}
  \bm{K}_{F}(s) = \frac{1}{s} \underbrace{\frac{s/\omega_i}{1 + s/\omega_i}}_{\text{HPF}} = \frac{1}{s + \omega_i}
\end{equation}


\subsection{Feedback Analysis}
\label{sec:org03090fc}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/loop_gain_modified_iff.pdf}
\caption{\label{fig:loop_gain_modified_iff}Bode Plot of the Loop Gain for IFF with and without the HPF}
\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/root_locus_modified_iff.pdf}
\caption{\label{fig:root_locus_modified_iff}Root Locus for IFF with and without the HPF}
\end{figure}

\subsection{Optimal Cut-Off Frequency}
\label{sec:org6ba4e55}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/root_locus_wi_modified_iff.pdf}
\caption{\label{fig:root_locus_wi_modified_iff}Root Locus for several HPF cut-off frequencies \(\omega_i\)}
\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/mod_iff_damping_wi.pdf}
\caption{\label{fig:mod_iff_damping_wi}Attainable damping ratio \(\xi_\text{cl}\) as a function of the HPF cut-off frequency. Corresponding control gain \(g_\text{opt}\) and \(g_\text{max}\) are also shown}
\end{figure}

\section{Integral Force Feedback with Parallel Springs}
\label{sec:org90ec20f}
\subsection{Stiffness in Parallel with the Force Sensor}
\label{sec:org60d6640}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/system_parallel_springs.pdf}
\caption{\label{fig:system_parallel_springs}System with added springs \(k_p\) in parallel with the actuators}
\end{figure}

\begin{equation}
\begin{bmatrix} f_u \\ f_v \end{bmatrix} =
\bm{G}_k
\begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}

\begin{equation}
\begin{bmatrix} f_u \\ f_v \end{bmatrix} =
\frac{1}{G_{kp}}
\begin{bmatrix}
   G_{kz} & -G_{kc} \\
   G_{kc} &  G_{kz}
\end{bmatrix}
\begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}
With:
\begin{align}
  G_{kp} &= \left( \frac{s^2}{{\omega_0^\prime}^2} + 2\xi^\prime \frac{s}{{\omega_0^\prime}^2} + 1 - \frac{\Omega^2}{{\omega_0^\prime}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0^\prime}\frac{s}{\omega_0^\prime} \right)^2 \\
  G_{kz} &= \left( \frac{s^2}{{\omega_0^\prime}^2} + \frac{k_p}{k + k_p} - \frac{\Omega^2}{{\omega_0^\prime}^2} \right) \left( \frac{s^2}{{\omega_0^\prime}^2} + 2\xi^\prime \frac{s}{{\omega_0^\prime}^2} + 1 - \frac{\Omega^2}{{\omega_0^\prime}^2} \right) + \left( 2 \frac{\Omega}{\omega_0^\prime}\frac{s}{\omega_0^\prime} \right)^2 \\
  G_{kc} &= \left( 2 \xi^\prime \frac{s}{\omega_0^\prime} + \frac{k}{k + k_p} \right) \left( 2 \frac{\Omega}{\omega_0^\prime}\frac{s}{\omega_0^\prime} \right)
\end{align}

where:
\begin{itemize}
\item \(\omega_0^\prime = \frac{k + k_p}{m}\)
\item \(\xi^\prime = \frac{c}{2 \sqrt{(k + k_p) m}}\)
\end{itemize}

\subsection{Effect of the Parallel Stiffness on the Plant Dynamics}
\label{sec:org3ec34fe}

\begin{equation}
  \frac{k_p}{k + k_p} - \frac{\Omega^2}{{\omega_0^\prime}^2} > 0
\end{equation}
Which is equivalent to
\begin{equation}
  k_p > m \Omega^2
\end{equation}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/plant_iff_kp.pdf}
\caption{\label{fig:plant_iff_kp}Bode Plot of \(f_u/F_u\) without parallel spring, with parallel springs with stiffness \(k_p < m \Omega^2\) and \(k_p > m \Omega^2\)}
\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/root_locus_iff_kp.pdf}
\caption{\label{fig:root_locus_iff_kp}Root Locus for IFF without parallel spring, with parallel springs with stiffness \(k_p < m \Omega^2\) and \(k_p > m \Omega^2\)}
\end{figure}

\subsection{Optimal Parallel Stiffness}
\label{sec:org9c47159}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/root_locus_iff_kps.pdf}
\caption{\label{fig:root_locus_iff_kps}Root Locus for IFF for several parallel spring stiffnesses \(k_p\)}
\end{figure}


\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/root_locus_opt_gain_iff_kp.pdf}
\caption{\label{fig:root_locus_opt_gain_iff_kp}Root Locus for IFF with \(k_p = 5 m \Omega^2\). The poles of the system using the gain that yields the maximum damping ratio are shown by black crosses}
\end{figure}

\section{Direct Velocity Feedback}
\label{sec:org5cb3076}
\subsection{Control Schematic}
\label{sec:orgaaa522f}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/system_dvf.pdf}
\caption{\label{fig:system_dvf}System with relative velocity sensors and with decentralized controllers \(K_V\)}
\end{figure}

\subsection{Equations}
\label{sec:orge0a4555}

\begin{equation}
\begin{bmatrix} v_u \\ v_v \end{bmatrix} =
\bm{G}_v
\begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}

\begin{equation}
\begin{bmatrix} v_u \\ v_v \end{bmatrix} =
\frac{s}{k} \frac{1}{G_{vp}}
\begin{bmatrix}
   G_{vz} & G_{vc} \\
  -G_{vc} & G_{vz}
\end{bmatrix}
\begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}
With:
\begin{align}
  G_{vp} &= \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2 \\
  G_{vz} &= \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \\
  G_{vc} &= 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0}
\end{align}


\subsection{Relative Direct Velocity Feedback}
\label{sec:org5401110}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/root_locus_dvf.pdf}
\caption{\label{fig:root_locus_dvf}Root Locus for Decentralized Direct Velocity Feedback for several rotational speeds \(\Omega\)}
\end{figure}

\section{Comparison of the Proposed Active Damping Techniques for Rotating Positioning Stages}
\label{sec:org4cbf163}
\subsection{Physical Comparison}
\label{sec:org5eba275}



\subsection{Attainable Damping}
\label{sec:org44635e0}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/comp_root_locus.pdf}
\caption{\label{fig:comp_root_locus}Root Locus for the three proposed decentralized active damping techniques: IFF with HFP, IFF with parallel springs, and relative DVF}
\end{figure}


\subsection{Transmissibility and Compliance}
\label{sec:org58e9594}


\begin{figure}[htbp]
\begin{subfigure}[c]{0.45\linewidth}
\includegraphics[width=\linewidth]{figs/comp_compliance.pdf}
\caption{\label{fig:comp_compliance} Transmissibility}
\end{subfigure}
\begin{subfigure}[c]{0.45\linewidth}
\includegraphics[width=\linewidth]{figs/comp_transmissibility.pdf}
\caption{\label{fig:comp_transmissibility} Compliance}
\end{subfigure}
\caption{\label{fig:comp_active_damping}Comparison of the three proposed Active Damping Techniques}
\centering
\end{figure}

\section{Conclusion}
\label{sec:org292b448}
\label{sec:conclusion}

\section*{Acknowledgment}
\label{sec:orgff7af07}

\bibliography{ref.bib}
\end{document}
