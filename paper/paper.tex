% Created 2020-07-02 jeu. 09:22
% Intended LaTeX compiler: pdflatex
\documentclass{ISMA_USD2020}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage[most]{tcolorbox}
\usepackage{bm}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{array}
\usepackage{siunitx}
\usepackage{amsmath,amssymb,amsfonts, cases}
\usepackage{algorithmic, graphicx, textcomp}
\usepackage{xcolor, import, hyperref}
\usepackage{subcaption}
\usepackage[USenglish, english]{babel}
\setcounter{footnote}{1}
\input{config.tex}
\author[1,3] {T. Dehaeze}
\author[1,2] {C. Collette}
\affil[1] {Precision Mechatronics Laboratory\NewLineAffil University of Liege, Belgium \NewAffil}
\affil[2] {BEAMS Department\NewLineAffil Free University of Brussels, Belgium \NewAffil}
\affil[3] {European Synchrotron Radiation Facility \NewLineAffil Grenoble, France e-mail: \textbf{thomas.dehaeze@esrf.fr}}
\bibliographystyle{IEEEtran}
\usepackage{tikz}
\usetikzlibrary{shapes.misc,arrows,arrows.meta}
\date{}
\title{Active Damping of Rotating Positioning Platforms using Force Feedback}
\hypersetup{
 pdfauthor={},
 pdftitle={Active Damping of Rotating Positioning Platforms using Force Feedback},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 27.0.91 (Org mode 9.4)}, 
 pdflang={English}}
\begin{document}

\maketitle

\abstract{
    Abstract text to be done
}

\section{Introduction}
\label{sec:org7e0661e}
\label{sec:introduction}
Due to gyroscopic effects, the guaranteed robustness properties of Integral Force Feedback do not hold.
Either the control architecture can be slightly modified or mechanical changes in the system can be performed.
This paper has been published
The Matlab code that was use to obtain the results are available in \cite{dehaeze20_activ_dampin_rotat_posit_platf}.

\section{Dynamics of Rotating Positioning Platforms}
\label{sec:org526efa7}
\label{sec:dynamics}
\subsection{Model of a Rotating Positioning Platform}
\label{sec:orgf882853}
In order to study how the rotation of a positioning platforms does affect the use of integral force feedback, a model of an XY positioning stage on top of a rotating stage is developed.

The model is schematically represented in Figure \ref{fig:system} and forms the simplest system where gyroscopic forces can be studied.

The rotating stage is supposed to be ideal, meaning it induces a perfect rotation \(\theta(t) = \Omega t\) where \(\Omega\) is the rotational speed in \(\si{\radian\per\second}\).

The parallel XY positioning stage consists of two orthogonal actuators represented by three elements in parallel: a spring with a stiffness \(k\) in \(\si{\newton\per\meter}\), a dashpot with a damping coefficient \(c\) in \(\si{\newton\per\meter\second}\) and an ideal force source \(F_u, F_v\).
A payload with a mass \(m\) in \(\si{\kilo\gram}\) is mounted on the (rotating) XY stage.

Two reference frames are used: an inertial frame \((\vec{i}_x, \vec{i}_y, \vec{i}_z)\) and a uniform rotating frame \((\vec{i}_u, \vec{i}_v, \vec{i}_w)\) rigidly fixed on top of the rotating stage with \(\vec{i}_w\) aligned with the rotation axis.
The position of the payload is represented by \((d_u, d_v, 0)\) expressed in the rotating frame.

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/system.pdf}
\caption{\label{fig:system}Schematic of the studied System}
\end{figure}

\subsection{Equations of Motion}
\label{sec:org54d120d}
To obtain of equation of motion for the system represented in Figure \ref{fig:system}, the Lagrangian equations are used:
\begin{equation}
\label{eq:lagrangian_equations}
  \frac{d}{dt} \left( \frac{\partial L}{\partial \dot{q}_i} \right) + \frac{\partial D}{\partial \dot{q}_i} - \frac{\partial L}{\partial q_i} = Q_i
\end{equation}
with \(L = T - V\) the Lagrangian, \(D\) the dissipation function, and \(Q_i\) the generalized force associated with the generalized variable \(\begin{bmatrix}q_1 & q_2\end{bmatrix} = \begin{bmatrix}d_u & d_v\end{bmatrix}\).

The constant rotation in the \((\vec{i}_x, \vec{i}_y)\) plane is here disregarded as it is imposed by the ideal rotating stage.
\begin{subequations}
\label{eq:energy_functions_lagrange}
  \begin{align}
    T & = \frac{1}{2} m \left( \left( \dot{d}_u - \Omega d_v \right)^2 + \left( \dot{d}_v + \Omega d_u \right)^2 \right) \\
    V & = \frac{1}{2} k \left( {d_u}^2 + {d_v}^2 \right) \\
    D & = \frac{1}{2} c \left( \dot{d}_u{}^2 + \dot{d}_v{}^2 \right) \\
    Q_1 &= F_u, \quad Q_2 = F_v
  \end{align}
\end{subequations}

Substituting equations \eqref{eq:energy_functions_lagrange} into \eqref{eq:lagrangian_equations} gives two coupled differential equations
\begin{subequations}
\label{eq:eom_coupled}
  \begin{align}
    m \ddot{d}_u + c \dot{d}_u + ( k - m \Omega^2 ) d_u &= F_u + 2 m \Omega \dot{d}_v \\
    m \ddot{d}_v + c \dot{d}_v + ( k \underbrace{-\,m \Omega^2}_{\text{Centrif.}} ) d_v &= F_v \underbrace{-\,2 m \Omega \dot{d}_u}_{\text{Coriolis}}
  \end{align}
\end{subequations}

The uniform rotation of the system induces two Gyroscopic effects as shown in Eq. \eqref{eq:eom_coupled}:
\begin{itemize}
\item Centrifugal forces: that can been seen as added negative stiffness \(- m \Omega^2\) along \(\vec{i}_u\) and \(\vec{i}_v\)
\item Coriolis Forces: that couples the motion in the two orthogonal directions
\end{itemize}

One can verify that without rotation (\(\Omega = 0\)) the system becomes equivalent as to two uncoupled one degree of freedom mass-spring-damper systems:
\begin{subequations}
\label{eq:oem_no_rotation}
  \begin{align}
    m \ddot{d}_u + c \dot{d}_u + k d_u &= F_u \\
    m \ddot{d}_v + c \dot{d}_v + k d_v &= F_v
  \end{align}
\end{subequations}

\subsection{Transfer Functions in the Laplace domain}
\label{sec:org13cedeb}
To study the dynamics of the system, the differential equations of motions \eqref{eq:eom_coupled} are transformed in the Laplace domain and the \(2 \times 2\) transfer function matrix \(\bm{G}_d\) from \(\begin{bmatrix}F_u & F_v\end{bmatrix}\) to \(\begin{bmatrix}d_u & d_v\end{bmatrix}\) is obtained
\begin{align}
  \begin{bmatrix} d_u \\ d_v \end{bmatrix} &= \bm{G}_d \begin{bmatrix} F_u \\ F_v \end{bmatrix} \label{eq:Gd_mimo_tf} \\
  \bm{G}_{d} &=
  \begin{bmatrix}
    \frac{ms^2 + cs + k - m \Omega^2}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2} & \frac{2 m \Omega s}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2} \\
    \frac{-2 m \Omega s}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2} & \frac{ms^2 + cs + k - m \Omega^2}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2}
  \end{bmatrix} \label{eq:Gd_m_k_c}
\end{align}

To simplify the analysis, the undamped natural frequency \(\omega_0\) and the damping ratio \(\xi\) are used
\begin{subequations}
  \begin{align}
    \omega_0 &= \sqrt{\frac{k}{m}} \text{ in } \si{\radian\per\second} \\
    \xi &= \frac{c}{2 \sqrt{k m}}
  \end{align}
\end{subequations}

The transfer function matrix \(\bm{G}_d\) \eqref{eq:Gd_m_k_c} becomes equal to
\begin{equation}
\label{eq:Gd_w0_xi_k}
\bm{G}_{d} =
  \frac{1}{k}
  \begin{bmatrix}
    \frac{\frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2}}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2} & \frac{2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0}}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2} \\
    \frac{- 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0}}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2} & \frac{\frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2}}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2}
  \end{bmatrix}
\end{equation}

For all the numerical analysis in this study, \(\omega_0 = \SI{1}{\radian\per\second}\), \(k = \SI{1}{\newton\per\meter}\) and \(\xi = 0.025 = \SI{2.5}{\percent}\).

Even tough no system with such parameters will be encountered in practice, conclusions will be drawn relative to these parameters such that they can be generalized to any other parameter.

\subsection{System Dynamics and Campbell Diagram}
\label{sec:org859b848}
The poles of \(\bm{G}_d\) are the complex solutions \(p\) of
\begin{equation}
  \left( \frac{p^2}{{\omega_0}^2} + 2 \xi \frac{p}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{p}{\omega_0} \right)^2 = 0
\end{equation}

Supposing small damping (\(\xi \ll 1\)), two pairs of complex conjugate poles are obtained:
\begin{subequations}
\label{eq:pole_values}
  \begin{align}
    p_{+} &= - \xi \omega_0 \left( 1 + \frac{\Omega}{\omega_0} \right) \pm j \omega_0 \left( 1 + \frac{\Omega}{\omega_0} \right) \\
    p_{-} &= - \xi \omega_0 \left( 1 - \frac{\Omega}{\omega_0} \right) \pm j \omega_0 \left( 1 - \frac{\Omega}{\omega_0} \right)
  \end{align}
\end{subequations}

The real part and complex part of these two pairs of complex conjugate poles are represented in Figure \ref{fig:campbell_diagram} as a function of the rotational speed \(\Omega\).
As the rotational speed increases, \(p_{+}\) goes to higher frequencies and \(p_{-}\) to lower frequencies.
The system becomes unstable for \(\Omega > \omega_0\) as the real part of \(p_{-}\) is positive.
Physically, the negative stiffness term \(-m\Omega^2\) induced by centrifugal forces exceeds the spring stiffness \(k\).

In the rest of this study, rotational speeds smaller than the undamped natural frequency of the system are assumed (\(\Omega < \omega_0\)).

\begin{figure}[htbp]
\begin{subfigure}[c]{0.4\linewidth}
\includegraphics[width=\linewidth]{figs/campbell_diagram_real.pdf}
\caption{\label{fig:campbell_diagram_real} Real Part}
\end{subfigure}
\begin{subfigure}[c]{0.4\linewidth}
\includegraphics[width=\linewidth]{figs/campbell_diagram_imag.pdf}
\caption{\label{fig:campbell_diagram_imag} Imaginary Part}
\end{subfigure}
\caption{\label{fig:campbell_diagram}Campbell Diagram : Evolution of the complex and real parts of the system's poles as a function of the rotational speed \(\Omega\)}
\centering
\end{figure}

Looking at the transfer function matrix \(\bm{G}_d\) in Eq. \eqref{eq:Gd_w0_xi_k}, one can see that the two diagonal (direct) terms are equal and the two off-diagonal (coupling) terms are opposite.
The bode plot of these two distinct terms are shown in Figure \ref{fig:plant_compare_rotating_speed} for several rotational speeds \(\Omega\).

It is confirmed that the two pairs of complex conjugate poles are further separated as \(\Omega\) increases.
For \(\Omega > \omega_0\), the low frequency complex conjugate poles \(p_{-}\) becomes unstable.

\begin{figure}[htbp]
\begin{subfigure}[c]{0.45\linewidth}
\includegraphics[width=\linewidth]{figs/plant_compare_rotating_speed_direct.pdf}
\caption{\label{fig:plant_compare_rotating_speed_direct} Direct Terms \(d_u/F_u\), \(d_v/F_v\)}
\end{subfigure}
\begin{subfigure}[c]{0.45\linewidth}
\includegraphics[width=\linewidth]{figs/plant_compare_rotating_speed_coupling.pdf}
\caption{\label{fig:plant_compare_rotating_speed_coupling} Coupling Terms \(d_v/F_u\), \(-d_u/F_v\)}
\end{subfigure}
\caption{\label{fig:plant_compare_rotating_speed}Bode Plots for \(\bm{G}_d\) for several rotational speed \(\Omega\)}
\centering
\end{figure}

\section{Decentralized Integral Force Feedback}
\label{sec:org8e753fb}
\label{sec:iff}
\subsection{Force Sensors and Control Architecture}
\label{sec:org536426c}
In order to apply IFF to the system, force sensors are added in series with the two actuators (Figure \ref{fig:system_iff}).
As this study focuses on decentralized control, two identical controllers \(K_F\) are used to feedback each of the sensed force to its associated actuator and no attempt is made to counteract the interactions in the system.
The control diagram is schematically shown in Figure \ref{fig:control_diagram_iff}.

\begin{minipage}[t]{0.55\linewidth}
\begin{center}
\includegraphics[scale=1]{figs/system_iff.pdf}
\captionof{figure}{\label{fig:system_iff}System with added Force Sensor in series with the actuators}
\end{center}
\end{minipage}
\hfill
\begin{minipage}[t]{0.40\linewidth}
\begin{center}
\includegraphics[scale=1]{figs/control_diagram_iff.pdf}
\captionof{figure}{\label{fig:control_diagram_iff}Control Diagram for decentralized IFF}
\end{center}
\end{minipage}

\subsection{Plant Dynamics}
\label{sec:orgffd14ec}
The forces measured by the two force sensors are equal to
\begin{equation}
\label{eq:measured_force}
  \begin{bmatrix} f_{u} \\ f_{v} \end{bmatrix} =
  \begin{bmatrix} F_u \\ F_v \end{bmatrix} - (c s + k)
  \begin{bmatrix} d_u \\ d_v \end{bmatrix}
\end{equation}

Re-injecting \eqref{eq:Gd_w0_xi_k} into \eqref{eq:measured_force} yields
\begin{equation}
\label{eq:Gf_mimo_tf}
  \begin{bmatrix} f_{u} \\ f_{v} \end{bmatrix} = \bm{G}_{f} \begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}
with \(\bm{G}_f\) a \(2 \times 2\) transfer function matrix
\begin{equation}
\label{eq:Gf}
  \bm{G}_{f} = \begin{bmatrix}
  \frac{\left( \frac{s^2}{{\omega_0}^2} - \frac{\Omega^2}{{\omega_0}^2} \right) \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right) + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2} & \frac{- \left( 2 \xi \frac{s}{\omega_0} + 1 \right) \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2} \\
  \frac{\left( 2 \xi \frac{s}{\omega_0} + 1 \right) \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2} & \frac{\left( \frac{s^2}{{\omega_0}^2} - \frac{\Omega^2}{{\omega_0}^2} \right) \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right) + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2}
\end{bmatrix}
\end{equation}

The zeros of the diagonal terms of \(\bm{G}_f\) are equal to (neglecting the damping for simplicity)
\begin{subequations}
  \begin{align}
    z_c &= \pm j \omega_0 \sqrt{\frac{1}{2} \sqrt{8 \frac{\Omega^2}{{\omega_0}^2} + 1} + \frac{\Omega^2}{{\omega_0}^2} + \frac{1}{2} } \label{eq:iff_zero_cc} \\
    z_r &= \pm   \omega_0 \sqrt{\frac{1}{2} \sqrt{8 \frac{\Omega^2}{{\omega_0}^2} + 1} - \frac{\Omega^2}{{\omega_0}^2} - \frac{1}{2} } \label{eq:iff_zero_real}
  \end{align}
\end{subequations}

It can be easily shown that the frequency of the two complex conjugate zeros \(z_c\) \eqref{eq:iff_zero_cc} lies between the frequency of the two pairs of complex conjugate poles \(p_{-}\) and \(p_{+}\) \eqref{eq:pole_values}.

For non-null rotational speeds, two real zeros \(z_r\) \eqref{eq:iff_zero_real} appear in the diagonal terms inducing a non-minimum phase behavior.
This can be seen in the Bode plot of the diagonal terms (Figure \ref{fig:plant_iff_compare_rotating_speed}) where the magnitude experiences an increase of its slope without any change of phase.

Similarly, the low frequency gain of \(\bm{G}_f\) is no longer zero and increases with the rotational speed \(\Omega\)
\begin{equation}
\label{low_freq_gain_iff_plan}
  \lim_{\omega \to 0} \left| \bm{G}_f (j\omega) \right| = \begin{bmatrix}
  \frac{\Omega^2}{{\omega_0}^2 - \Omega^2} & 0 \\
  0  & \frac{\Omega^2}{{\omega_0}^2 - \Omega^2}
\end{bmatrix}
\end{equation}

This low frequency gain can be explained as follows: a constant force \(F_u\) induces a small displacement of the mass \(d_u = \frac{F_u}{k - m\Omega^2}\), which increases the centrifugal force \(m\Omega^2d_u = \frac{\Omega^2}{{\omega_0}^2 - \Omega^2} F_u\) which is then measured by the force sensors.

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/plant_iff_compare_rotating_speed.pdf}
\caption{\label{fig:plant_iff_compare_rotating_speed}Bode plot of the diagonal terms of \(\bm{G}_f\) for several rotational speeds \(\Omega\)}
\end{figure}

\subsection{Decentralized Integral Force Feedback with Pure Integrators}
\label{sec:org07bf4ec}
The two IFF controllers \(K_F\) consist of a pure integrator
\begin{equation}
\label{eq:Kf_pure_int}
  \bm{K}_F(s) = \begin{bmatrix} K_F(s) & 0 \\ 0 & K_F(s) \end{bmatrix}, \quad K_F(s) = g \cdot \frac{1}{s}
\end{equation}
where \(g\) is a scalar representing the gain of the controller.

In order to see how the IFF affects the poles of the closed loop system, a Root Locus (Figure \ref{fig:root_locus_pure_iff}) is constructed as follows: the poles of the closed-loop system are drawn in the complex plane as the gain \(g\) varies from \(0\) to \(\infty\) for the two controllers simultaneously.
As explained in \cite{preumont08_trans_zeros_struc_contr_with,skogestad07_multiv_feedb_contr}, the closed-loop poles start at the open-loop poles (shown by \(\tikz[baseline=-0.6ex] \node[cross out, draw=black, minimum size=1ex, line width=2pt, inner sep=0pt, outer sep=0pt] at (0, 0){};\)) for \(g = 0\) and coincide with the transmission zeros (shown by \(\tikz[baseline=-0.6ex] \draw[line width=2pt, inner sep=0pt, outer sep=0pt] (0,0) circle[radius=3pt];\)) as \(g \to \infty\).
The direction of increasing gain is indicated by arrows \(\tikz[baseline=-0.6ex] \draw[-{Stealth[round]},line width=2pt] (0,0) -- (0.3,0);\).

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/root_locus_pure_iff.pdf}
\caption{\label{fig:root_locus_pure_iff}Root Locus for the Decentralized Integral Force Feedback for several rotating speeds \(\Omega\)}
\end{figure}

Whereas collocated IFF is usually associated with unconditional stability \cite{preumont91_activ}, this property is lost as soon as the rotational speed in non-null due to gyroscopic effects.
This can be seen in the Root Locus (Figure \ref{fig:root_locus_pure_iff}) where the pole corresponding to the controller is bounded to the right half plane implying closed-loop system instability.

Physically, this can be explained by realizing that below some frequency, the loop gain being very large, the decentralized IFF effectively decouples the payload from the XY stage.
Moreover, the payload experiences centrifugal forces, which can be modeled by negative stiffnesses pulling it away from the rotation axis rendering the system unstable, hence the poles in the right half plane.

In order to apply Decentralized IFF on rotating positioning stages, two solutions are proposed to deal with this instability problem.
The first one consists of slightly modifying the control law (Section \ref{sec:iff_hpf}) while the second one consists of adding springs in parallel with the force sensors (Section \ref{sec:iff_kp}).

\section{Integral Force Feedback with High Pass Filter}
\label{sec:org122be2f}
\label{sec:iff_hpf}
\subsection{Modification of the Control Low}
\label{sec:orgcbcee98}
In order to limit the low frequency controller gain, an high pass filter (HPF) can be added to the controller which becomes
\begin{equation}
\label{eq:IFF_LHF}
  \bm{K}_F(s) = \begin{bmatrix} K_F(s) & 0 \\ 0 & K_F(s) \end{bmatrix}, \quad K_{F}(s) = g \cdot \frac{1}{s} \cdot \underbrace{\frac{s/\omega_i}{1 + s/\omega_i}}_{\text{HPF}} = g \cdot \frac{1}{s + \omega_i}
\end{equation}

This is equivalent as to slightly shifting to controller pole to the left along the real axis.
This modification of the IFF controller is typically done to avoid saturation associated with the pure integrator \cite{preumont91_activ}.
This is however not the case in this study as it will become in the next section.

\subsection{Feedback Analysis}
\label{sec:orgfee3532}
The loop gains for an individual decentralized controller \(K_F(s)\) with and without the added HPF are shown in Figure \ref{fig:loop_gain_modified_iff}.
The effect of the added HPF is a limitation of the low frequency gain.

The Root Loci for the decentralized IFF with and without the HPF are displayed in Figure \ref{fig:root_locus_modified_iff}.
With the added HPF, the poles of the closed loop system are shown to be stable up to some value of the gain \(g_\text{max}\)
\begin{equation}
\label{eq:gmax_iff_hpf}
  g_{\text{max}} = \omega_i \left( \frac{{\omega_0}^2}{\Omega^2} - 1 \right)
\end{equation}
This gain also corresponds as to when the low frequency loop gain reaches one.

\begin{minipage}[b]{0.45\linewidth}
\begin{center}
\includegraphics[scale=1]{figs/loop_gain_modified_iff.pdf}
\captionof{figure}{\label{fig:loop_gain_modified_iff}Modification of the loop gain with the added HFP, \(g = 2\), \(\omega_i = 0.1 \omega_0\) and \(\Omega = 0.1 \omega_0\)}
\end{center}
\end{minipage}
\hfill
\begin{minipage}[b]{0.5\linewidth}
\begin{center}
\includegraphics[scale=1]{figs/root_locus_modified_iff.pdf}
\captionof{figure}{\label{fig:root_locus_modified_iff}Modification of the Root Locus with the added HPF, \(\omega_i = 0.1 \omega_0\) and \(\Omega = 0.1 \omega_0\)}
\end{center}
\end{minipage}

\subsection{Optimal Control Parameters}
\label{sec:org0971873}

Two parameters can be tuned for the controller \eqref{eq:IFF_LHF}: the gain \(g\) and the location of the pole \(\omega_i\).
The optimal values of \(\omega_i\) and \(g\) are considered as the values for which the damping of all the closed-loop poles are simultaneously maximized.

The Root Loci for several \(\omega_i\) are shown in Figure \ref{fig:root_locus_wi_modified_iff}.
It is shown that even tough small \(\omega_i\) seems to allow more damping to be added to the system resonances, the control gain \(g\) may be limited to small values due to Eq. \eqref{eq:gmax_iff_hpf}.

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/root_locus_wi_modified_iff.pdf}
\caption{\label{fig:root_locus_wi_modified_iff}Root Locus for several HPF cut-off frequencies \(\omega_i\), \(\Omega = 0.1 \omega_0\)}
\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/mod_iff_damping_wi.pdf}
\caption{\label{fig:mod_iff_damping_wi}Attainable damping ratio \(\xi_\text{cl}\) as a function of the ratio \(\omega_i/\omega_0\). Corresponding control gain \(g_\text{opt}\) and \(g_\text{max}\) are also shown}
\end{figure}

\section{Integral Force Feedback with Parallel Springs}
\label{sec:orgef66bd9}
\label{sec:iff_kp}
\subsection{Stiffness in Parallel with the Force Sensor}
\label{sec:org561caf7}

As was shown in the previous sections, the instability when using Decentralized IFF for rotating positioning platforms is due to Gyroscopic effects, more precisely to the negative stiffnesses induced by centrifugal forces.
The idea in this section is to include additional springs in parallel with the force sensors to counteract this negative stiffness.
Such springs are schematically shown in Figure \ref{fig:system_parallel_springs} where \(k_a\) is the stiffness of the actuator and \(k_p\) the stiffness in parallel with the actuator and force sensor.

Such system could consist of additional springs, or it could also be
This could represent a system where \ref{fig:cedrat_xy25xs}.
The use of such amplified piezoelectric actuator for IFF is discussed in  \cite{souleille18_concep_activ_mount_space_applic}.

\begin{minipage}[t]{0.55\linewidth}
\begin{center}
\includegraphics[scale=1]{figs/system_parallel_springs.pdf}
\captionof{figure}{\label{fig:system_parallel_springs}Studied system with additional springs in parallel with the actuators and force sensors}
\end{center}
\end{minipage}
\hfill
\begin{minipage}[t]{0.40\linewidth}
\begin{center}
\includegraphics[width=\linewidth]{figs/cedrat_xy25xs.png}
\captionof{figure}{\label{fig:cedrat_xy25xs}XY Piezoelectric Stage (XY25XS from Cedrat Technology)}
\end{center}
\end{minipage}

\subsection{Effect of the Parallel Stiffness on the Plant Dynamics}
\label{sec:org64ab164}
The forces measured by the sensors are equal to
\begin{equation}
\label{eq:measured_force_kp}
  \begin{bmatrix} f_{u} \\ f_{v} \end{bmatrix} =
  \begin{bmatrix} F_u \\ F_v \end{bmatrix} - (c s + k_a)
  \begin{bmatrix} d_u \\ d_v \end{bmatrix}
\end{equation}

A scalar parameter \(\alpha\) (\(0 \le \alpha < 1\)) is defined to describe the fraction of the total stiffness in parallel with the actuator and force sensor
\begin{subequations}
  \begin{align}
    k_p &= \alpha k \\
    k_a &= (1 - \alpha) k
  \end{align}
\end{subequations}
Note that the overall stiffness \(k = k_a + k_p\) is kept constant.

The equations of motion are derived and transformed in the Laplace domain
\begin{equation}
\label{eq:Gk_mimo_tf}
\begin{bmatrix} f_u \\ f_v \end{bmatrix} =
\bm{G}_k
\begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}
with \(\bm{G}_k\) a \(2 \times 2\) transfer function matrix
\begin{equation}
\label{eq:Gk}
\bm{G}_k =
\begin{bmatrix}
  \frac{\left( \frac{s^2}{{\omega_0}^2} - \frac{\Omega^2}{{\omega_0}^2} + \alpha \right) \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right) + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2} & \frac{- \left( 2 \xi \frac{s}{\omega_0} + 1 - \alpha \right) \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2} \\
  \frac{\left( 2 \xi \frac{s}{\omega_0} + 1 - \alpha \right) \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2} & \frac{\left( \frac{s^2}{{\omega_0}^2} - \frac{\Omega^2}{{\omega_0}^2} + \alpha \right) \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right) + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2}{\left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2}
\end{bmatrix}
\end{equation}

Comparing \(\bm{G}_k\) \eqref{eq:Gk} with \(\bm{G}_f\) \eqref{eq:Gf} shows that while the poles of the system are kept the same, the zeros of the diagonal terms have changed.

The two real zeros \(z_r\) \eqref{eq:iff_zero_real} that were inducing non-minimum phase behavior are transformed into complex conjugate zeros for
\begin{equation}
  \begin{aligned}
    \alpha &> \frac{\Omega^2}{{\omega_0}^2} \\
    \Leftrightarrow k_p &> m \Omega^2
  \end{aligned}
\end{equation}

Thus, if the added parallel stiffness \(k_p\) is higher than the negative stiffness induced by centrifugal forces \(m \Omega^2\), the direct dynamics from actuator to force sensor will show minimum phase behavior.
This is confirmed by the Bode plot in Figure \ref{fig:plant_iff_kp}.

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/plant_iff_kp.pdf}
\caption{\label{fig:plant_iff_kp}Bode Plot of \(f_u/F_u\) without parallel spring, with parallel springs with stiffness \(k_p < m \Omega^2\) and \(k_p > m \Omega^2\), \(\Omega = 0.1 \omega_0\)}
\end{figure}

Figure \ref{fig:root_locus_iff_kp} shows Root Loci plots for \(k_p = 0\), \(k_p < m \Omega^2\) and \(k_p > m \Omega^2\) when \(K_F\) is a pure integrator \eqref{eq:Kf_pure_int}.
It is shown that if the added stiffness is higher than the maximum negative stiffness, the poles of the closed-loop system stay in the (stable) right half-plane, and hence the unconditional stability of IFF is recovered.

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/root_locus_iff_kp.pdf}
\caption{\label{fig:root_locus_iff_kp}Root Locus for IFF without parallel spring, with parallel springs with stiffness \(k_p < m \Omega^2\) and \(k_p > m \Omega^2\), \(\Omega = 0.1 \omega_0\)}
\end{figure}

\subsection{Optimal Parallel Stiffness}
\label{sec:org8d24b66}
Figure \ref{fig:root_locus_iff_kps} shows Root Loci plots for several parallel stiffnesses \(k_p > m \Omega^2\).
It is shown that large parallel stiffness \(k_p\) reduces the attainable damping.
This can be explained by the fact that as the parallel stiffnesses increases, the transmission zeros are closer to the poles.
As explained in \cite{preumont18_vibrat_contr_activ_struc_fourt_edition}, the attainable damping is generally proportional to the distance between the poles and zeros.
The frequency of the transmission zeros of the system are increasing with the fraction used as parallel stiffness \(k_p\).

For any \(k_p > m \Omega^2\), the control gain \(g\) can be tuned such that the maximum simultaneous damping is added to the resonances of the system as shown in Figure \ref{fig:root_locus_opt_gain_iff_kp} for \(k_p = 5 m \Omega^2\).

\begin{figure}[htbp]
\begin{subfigure}[c]{0.49\linewidth}
\includegraphics[width=\linewidth]{figs/root_locus_iff_kps.pdf}
\caption{\label{fig:root_locus_iff_kps} Comparison of three parallel stiffnesses \(k_p\)}
\end{subfigure}
\begin{subfigure}[c]{0.49\linewidth}
\includegraphics[width=\linewidth]{figs/root_locus_opt_gain_iff_kp.pdf}
\caption{\label{fig:root_locus_opt_gain_iff_kp} \(k_p = 5 m \Omega^2\), optimal damping \(\xi_\text{opt}\) is shown}
\end{subfigure}
\caption{\label{fig:root_locus_iff_kps_opt}Root Locus for IFF when parallel stiffness \(k_p\) is added, \(\Omega = 0.1 \omega_0\)}
\centering
\end{figure}

\section{Comparison of the Proposed Modification to Decentralized Integral Force Feedback for Rotating Positioning Stages}
\label{sec:orgc33a2c0}
\label{sec:comparison}
The two proposed modification to the decentralized IFF for rotating positioning stages are now compared.
Two modification to the decentralized IFF for rotating positioning stages have been proposed.

The first modification concerns the controller.
It consists of adding an high pass filter to \(K_F\) \eqref{eq:IFF_LHF}.
This allows the system to be stable for gains up to \(g_\text{max}\) \eqref{eq:gmax_iff_hpf}.

The second proposed modification concerns the mechanical system.
If springs are added in parallel to the actuators and force sensors with a stiffness \(k_p > m \Omega^2\), decentralized IFF can be applied with unconditional stability.

These two methods are now compared in terms of added damping, closed-loop compliance and transmissibility.
For the following comparisons, the high pass cut-off frequency is set to \(\omega_i = 0.1 \omega_0\) and the parallel stiffness is \(k_p = 5 m \Omega^2\).
\subsection{Comparison of the Attainable Damping}
\label{sec:org7077499}
Figure \ref{fig:comp_root_locus} shows to Root Locus plots for the two proposed IFF techniques.
The maximum added damping is very similar for both techniques and are reached for \(g_\text{opt} \approx 2\) in both cases.

\begin{figure}[htbp]
\centering
\includegraphics[scale=1]{figs/comp_root_locus.pdf}
\caption{\label{fig:comp_root_locus}Root Locus for the two proposed modifications of decentralized IFF, \(\Omega = 0.1 \omega_0\)}
\end{figure}

\subsection{Comparison Transmissibility and Compliance}
\label{sec:org4ef5531}
The two proposed techniques are now compared in terms of closed-loop compliance and transmissibility.

The compliance is defined as the transfer function from external forces applied to the payload to the displacement of the payload in an inertial frame.
The transmissibility is the dynamics from the displacement of the rotating stage to the displacement of the payload.
It is used to characterize how much vibration of the rotating stage is transmitted to the payload.

The two techniques are also compared with passive damping (Figure \ref{fig:system}) with \(c\) tuned to critically damp the resonance when \(\Omega = 0\)
\begin{equation}
  c_\text{crit} = 2 \sqrt{k m}
\end{equation}

Very similar results are obtained for both techniques as shown in Figures \ref{fig:comp_compliance} and \ref{fig:comp_transmissibility}.
It is also confirmed that these techniques can significantly damp the system's resonances.

Compared to passive damping, the two techniques degrades the compliance at low frequency (Figure \ref{fig:comp_compliance}).
They however do not degrades the transmissibility as high frequency as its the case with passive damping (Figure \ref{fig:comp_transmissibility})

\begin{figure}[htbp]
\begin{subfigure}[c]{0.45\linewidth}
\includegraphics[width=\linewidth]{figs/comp_compliance.pdf}
\caption{\label{fig:comp_compliance} Compliance}
\end{subfigure}
\begin{subfigure}[c]{0.45\linewidth}
\includegraphics[width=\linewidth]{figs/comp_transmissibility.pdf}
\caption{\label{fig:comp_transmissibility} Transmissibility}
\end{subfigure}
\caption{\label{fig:comp_active_damping}Comparison of the two proposed Active Damping Techniques, \(\Omega = 0.1 \omega_0\)}
\centering
\end{figure}

\section{Conclusion}
\label{sec:org340aa08}
\label{sec:conclusion}

\section*{Acknowledgment}
\label{sec:orge888fc9}
This research benefited from a FRIA grant from the French Community of Belgium.

\bibliography{ref.bib}
\end{document}
