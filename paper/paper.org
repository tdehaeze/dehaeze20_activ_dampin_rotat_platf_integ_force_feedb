#+TITLE: Active Damping of Rotating Positioning Platforms
:DRAWER:
#+LATEX_CLASS: ISMA_USD2020
#+OPTIONS: toc:nil
#+STARTUP: overview

#+DATE:
#+AUTHOR:

#+LATEX_HEADER_EXTRA: \author[1,3] {T. Dehaeze}
#+LATEX_HEADER_EXTRA: \author[1,2] {C. Collette}

#+LATEX_HEADER_EXTRA: \affil[1] {Precision Mechatronics Laboratory\NewLineAffil University of Liege, Belgium \NewAffil}
#+LATEX_HEADER_EXTRA: \affil[2] {BEAMS Department\NewLineAffil Free University of Brussels, Belgium \NewAffil}
#+LATEX_HEADER_EXTRA: \affil[3] {European Synchrotron Radiation Facility \NewLineAffil Grenoble, France e-mail: \textbf{thomas.dehaeze@esrf.fr}}

#+LATEX_HEADER_EXTRA: \bibliographystyle{IEEEtran}

#+LATEX_HEADER: \usepackage{amsmath,amssymb,amsfonts, cases}
#+LATEX_HEADER: \usepackage{algorithmic, graphicx, textcomp}
#+LATEX_HEADER: \usepackage{xcolor, import, hyperref}
#+LATEX_HEADER: \usepackage[USenglish]{babel}
#+LATEX_HEADER_EXTRA: \usepackage{tikz}
#+LATEX_HEADER_EXTRA: \usetikzlibrary{shapes.misc}


#+LATEX_HEADER: \setcounter{footnote}{1}
#+LATEX_HEADER: \input{config.tex}
:END:

* LaTeX Config                                                     :noexport:
#+begin_src latex :tangle config.tex

#+end_src

* Build                                                            :noexport:
#+NAME: startblock
#+BEGIN_SRC emacs-lisp :results none
  (add-to-list 'org-latex-classes
               '("ISMA_USD2020"
                 "\\documentclass{ISMA_USD2020}"
                 ("\\section{%s}" . "\\section*{%s}")
                 ("\\subsection{%s}" . "\\subsection*{%s}")
                 ("\\subsubsection{%s}" . "\\subsubsection*{%s}")
                 ("\\paragraph{%s}" . "\\paragraph*{%s}")
                 ("\\subparagraph{%s}" . "\\subparagraph*{%s}"))
               )
#+END_SRC

* Abstract                                                           :ignore:
#+BEGIN_EXPORT latex
\abstract{
    Abstract text to be done
}
#+END_EXPORT

* Introduction
<<sec:introduction>>
*** Establish the importance of the research topic                 :ignore:
# Active Damping + Rotating System

Controller Poles are shown by black crosses (
\begin{tikzpicture} \node[cross out, draw=black, minimum size=1ex, line width=2pt, inner sep=0pt, outer sep=0pt] at (0, 0){}; \end{tikzpicture}
).

*** Applications of active damping                                  :ignore:
# Link to previous paper / tomography

cite:dehaeze18_sampl_stabil_for_tomog_exper

*** Current active damping techniques                               :ignore:
# IFF, DVF

*** Describe a gap in the research                                 :ignore:
# No literature on rotating systems => gyroscopic effects

*** Describe the paper itself / the problem which is addressed     :ignore:

*** Introduce Each part of the paper                               :ignore:

* System Under Study
** Rotating Positioning Platform
# Simplest system where gyroscopic forces can be studied
Consider the rotating X-Y stage of Figure [[fig:rotating_xy_platform]].

# Present the system, parameters, assumptions

# Small displacements

# Constant rotating speed

# Explain the frames (inertial frame x,y, rotating frame u,v)

- $k$: Actuator's Stiffness [N/m]
- $m$: Payload's mass [kg]
- $\Omega = \dot{\theta}$: rotation speed [rad/s]
- $F_u$, $F_v$
- $d_u$, $d_v$

#+name: fig:rotating_xy_platform
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/system.pdf]]


#+name: fig:cedrat_xy25xs
#+caption: Figure caption
#+attr_latex: :width 0.5\linewidth
[[file:figs/cedrat_xy25xs.jpg]]

** Equation of Motion
The system has two degrees of freedom and is thus fully described by the generalized coordinates $u$ and $v$.

Let's express the kinetic energy $T$ and the potential energy $V$ of the mass $m$ (neglecting the rotational energy):

Dissipation function $R$
Kinetic energy $T$
Potential energy $V$
\begin{subequations}
  \begin{align}
    T & = \frac{1}{2} m \left( \left( \dot{u} - \Omega v \right)^2 + \left( \dot{v} + \Omega u \right)^2 \right) \\
    R & = \frac{1}{2} c \left( \dot{u}^2 + \dot{v}^2 \right) \\
    V & = \frac{1}{2} k \left( u^2 + v^2 \right)
  \end{align}
\end{subequations}

The Lagrangian is the kinetic energy minus the potential energy:
\begin{equation}
L = T - V
\end{equation}

From the Lagrange's equations of the second kind, the equation of motion is obtained ($q_1 = u$, $q_2 = v$).
\begin{equation}
  \frac{d}{dt} \left( \frac{\partial L}{\partial \dot{q}_i} \right) + \frac{\partial D}{\partial \dot{q}_i} - \frac{\partial L}{\partial q_i} = Q_i
\end{equation}
with $Q_i$ is the generalized force associated with the generalized variable $q_i$ ($Q_1 = F_u$ and $Q_2 = F_v$).


\begin{subequations}
  \begin{align}
    m \ddot{u} + c \dot{u} + ( k - m \Omega ) u &= F_u + 2 m \Omega \dot{v} \\
    m \ddot{v} + c \dot{v} + ( k \underbrace{-\,m \Omega}_{\text{Centrif.}} ) v &= F_v \underbrace{-\,2 m \Omega \dot{u}}_{\text{Coriolis}}
  \end{align}
\end{subequations}

# Explain Gyroscopic effects
- Coriolis Forces: coupling
- Centrifugal forces: negative stiffness

Without the coupling terms, each equation is the equation of a one degree of freedom mass-spring system with mass $m$ and stiffness $k- m\dot{\theta}^2$.
Thus, the term $- m\dot{\theta}^2$ acts like a negative stiffness (due to *centrifugal forces*).


** Transfer Functions in the Laplace domain

# Laplace Domain
\begin{subequations}
  \begin{align}
    u &= \frac{ms^2 + cs + k - m \Omega^2}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2} F_u +  \frac{2 m \Omega s}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2} F_v \\
    v &= \frac{-2 m \Omega s}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2} F_u +  \frac{ms^2 + cs + k - m \Omega^2}{\left( m s^2 + cs + k - m \Omega^2 \right)^2 + \left( 2 m \Omega s \right)^2} F_v
  \end{align}
\end{subequations}

# Change of variables
\begin{equation}
\begin{bmatrix} d_u \\ d_v \end{bmatrix} =
\bm{G}_d
\begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}
Where $\bm{G}_d$ is a $2 \times 2$ transfer function matrix.

\begin{equation}
\bm{G}_d = \frac{1}{k} \frac{1}{G_{dp}}
\begin{bmatrix}
   G_{dz} & G_{dc} \\
  -G_{dc} & G_{dz}
\end{bmatrix}
\end{equation}
With:
\begin{subequations}
  \begin{align}
    G_{dp} &= \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2 \\
    G_{dz} &= \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \\
    G_{dc} &= 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0}
  \end{align}
\end{subequations}

- $\omega_0 = \sqrt{\frac{k}{m}}$: Natural frequency of the mass-spring system in $\si{\radian/\s}$
- $\xi$ damping ratio


** Constant Rotating Speed
To simplify, let's consider a constant rotating speed $\dot{\theta} = \Omega$ and thus $\ddot{\theta} = 0$.

#+NAME: eq:coupledplant
\begin{equation}
\begin{bmatrix} d_u \\ d_v \end{bmatrix} =
\frac{1}{(m s^2 + (k - m{\omega_0}^2))^2 + (2 m {\omega_0} s)^2}
\begin{bmatrix}
  ms^2 + (k-m{\omega_0}^2) & 2 m \omega_0 s \\
  -2 m \omega_0 s          & ms^2 + (k-m{\omega_0}^2) \\
\end{bmatrix}
\begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}

# Explain each term

#+NAME: eq:coupled_plant
\begin{equation}
\begin{bmatrix} d_u \\ d_v \end{bmatrix} =
\frac{\frac{1}{k}}{\left( \frac{s^2}{{\omega_0}^2} + (1 - \frac{{\Omega}^2}{{\omega_0}^2}) \right)^2 + \left( 2 \frac{{\Omega} s}{{\omega_0}^2} \right)^2}
\begin{bmatrix}
  \frac{s^2}{{\omega_0}^2} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} & 2 \frac{\Omega s}{{\omega_0}^2} \\
  -2 \frac{\Omega s}{{\omega_0}^2}          & \frac{s^2}{{\omega_0}^2} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \\
\end{bmatrix}
\begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}

When the rotation speed is null, the coupling terms are equal to zero and the diagonal terms corresponds to one degree of freedom mass spring system.
#+NAME: eq:coupled_plant_no_rot
\begin{equation}
\begin{bmatrix} d_u \\ d_v \end{bmatrix} =
\frac{\frac{1}{k}}{\frac{s^2}{{\omega_0}^2} + 1}
\begin{bmatrix}
  1 & 0 \\
  0 & 1
\end{bmatrix}
\begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}

# Campbell Diagram

When the rotation speed in not null, the resonance frequency is duplicated into two pairs of complex conjugate poles.
As the rotation speed increases, one of the two resonant frequency goes to lower frequencies as the other one goes to higher frequencies (Figure [[fig:campbell_diagram]]).

#+name: fig:campbell_diagram
#+caption: Campbell Diagram
#+attr_latex: :scale 1
[[file:figs/campbell_diagram.pdf]]

# Bode Plots for different ratio wr/w0

The magnitude of the coupling terms are increasing with the rotation speed.

#+name: fig:plant_compare_rotating_speed
#+caption: Caption
#+attr_latex: :scale 1
[[file:figs/plant_compare_rotating_speed.pdf]]

* Integral Force Feedback
** Control Schematic

Force Sensors are added in series with the actuators as shown in Figure [[fig:system_iff]].

# Reference to IFF control

#+name: fig:system_iff
#+caption: System with Force Sensors in Series with the Actuators. Decentralized Integral Force Feedback is used
#+attr_latex: :scale 1
[[file:figs/system_iff.pdf]]

** Equations
The sensed forces are equal to:
\begin{equation}
\begin{bmatrix} f_{u} \\ f_{v} \end{bmatrix} =
\begin{bmatrix} F_u \\ F_v \end{bmatrix} - (c s + k)
\begin{bmatrix} d_u \\ d_v \end{bmatrix}
\end{equation}

Which then gives:
\begin{equation}
\begin{bmatrix} f_{u} \\ f_{v} \end{bmatrix} =
\bm{G}_{f}
\begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}

\begin{equation}
\begin{bmatrix} f_{u} \\ f_{v} \end{bmatrix} =
\frac{1}{G_{fp}}
\begin{bmatrix}
  G_{fz} & -G_{fc} \\
  G_{fc} &  G_{fz}
\end{bmatrix}
\begin{bmatrix} F_u \\ F_v \end{bmatrix}
\end{equation}

\begin{align}
  G_{fp} &= \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right)^2 + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2 \\
  G_{fz} &= \left( \frac{s^2}{{\omega_0}^2} - \frac{\Omega^2}{{\omega_0}^2} \right) \left( \frac{s^2}{{\omega_0}^2} + 2 \xi \frac{s}{\omega_0} + 1 - \frac{{\Omega}^2}{{\omega_0}^2} \right) + \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)^2 \\
  G_{fc} &= \left( 2 \xi \frac{s}{\omega_0} + 1 \right) \left( 2 \frac{\Omega}{\omega_0} \frac{s}{\omega_0} \right)
\end{align}


** Plant Dynamics

# General explanation for the Root Locus Plot

# MIMO root locus: gain is simultaneously increased for both decentralized controllers

# Explain the circles, crosses and black crosses (poles of the controller)

#+name: fig:root_locus_pure_iff
#+caption: Root Locus
#+attr_latex: :scale 1
[[file:figs/root_locus_pure_iff.pdf]]

** Physical Interpretation

At low frequency, the gain is very large and thus no force is transmitted between the payload and the rotating stage.
This means that at low frequency, the system is decoupled (the force sensor removed) and thus the system is unstable.

* Integral Force Feedback with High Pass Filters
** Modification of the Control Low

# Reference to Preumont where its done

# Explain why it is usually done and why it is done here: the problem is the high gain at low frequency => high pass filter

** Close Loop Analysis

#+name: fig:loop_gain_modified_iff
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/loop_gain_modified_iff.pdf]]

#+name: fig:root_locus_modified_iff
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/root_locus_modified_iff_ter.pdf]]

** Optimal Cut-Off Frequency

#+name: fig:root_locus_wi_modified_iff
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/root_locus_wi_modified_iff_bis.pdf]]


#+name: fig:mod_iff_damping_wi
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/mod_iff_damping_wi.pdf]]

* Integral Force Feedback with Parallel Springs

#+name: fig:rotating_xy_platform_springs
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/rotating_xy_platform_springs.pdf]]

#+name: fig:plant_iff_kp
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/plant_iff_kp.pdf]]

#+name: fig:root_locus_iff_kps
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/root_locus_iff_kps.pdf]]

#+name: fig:root_locus_iff_kp_bis
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/root_locus_iff_kp_ter.pdf]]

#+name: fig:root_locus_opt_gain_iff_kp
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/root_locus_opt_gain_iff_kp.pdf]]

#+name: fig:plant_iff_compare_rotating_speed
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/plant_iff_compare_rotating_speed.pdf]]

* Direct Velocity Feedback

#+name: fig:root_locus_dvf
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/root_locus_dvf.pdf]]

* Comparison of the Proposed Active Damping Techniques

#+name: fig:comp_root_locus
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/comp_root_locus.pdf]]

#+name: fig:comp_compliance
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/comp_compliance.pdf]]

#+name: fig:comp_transmissibility
#+caption: Figure caption
#+attr_latex: :scale 1
[[file:figs/comp_transmissibility.pdf]]

* Conclusion
<<sec:conclusion>>


* Acknowledgment
:PROPERTIES:
:UNNUMBERED: t
:END:

* Bibliography                                                       :ignore:
\bibliography{ref.bib}
